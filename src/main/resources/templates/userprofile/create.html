<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Create Profile</title>
    <style>
        /* (Your existing styles should go here for form-container, text-danger, etc.) */
        body { font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #74ebd5 0%, #9face6 100%); margin: 0; padding: 0; }
        .form-container { max-width: 550px; margin: 60px auto; background: #ffffff; padding: 35px 30px; border-radius: 16px; box-shadow: 0 6px 18px rgba(0, 0, 0, 0.15); }
        .profile-img-preview { width: 120px; height: 120px; border-radius: 50%; overflow: hidden; margin: 0 auto 20px; border: 3px solid #4a90e2; display: flex; justify-content: center; align-items: center; background-color: #f0f0f0; }
        .profile-img-preview img { width: 100%; height: 100%; object-fit: cover; }
        .form-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 6px; font-weight: 500; }
        input[type="text"], input[type="email"], input[type="file"], select { width: 100%; padding: 12px 14px; margin-bottom: 18px; border: 1px solid #dcdde1; border-radius: 8px; }
        .text-danger { color: #dc3545; font-size: 14px; margin-top: -10px; margin-bottom: 10px; display: block; }
        .is-invalid { border-color: #dc3545 !important; }
        .d-flex { display: flex; justify-content: space-between; gap: 10px; }
        .btn-primary, .btn-secondary { padding: 12px 20px; border-radius: 8px; border: none; cursor: pointer; }
        .btn-primary { background: #4a90e2; color: #fff; }
        .btn-secondary { background: #e0e0e0; color: #333; text-decoration: none; }
    </style>
</head>
<body>


<div class="form-container">
    <h2>Create User Profile</h2>

    <div th:if="${errorMessage}" class="error-msg">
        <p th:text="${errorMessage}"></p>
    </div>

    <form th:action="@{/userprofile/save}" 
          th:object="${userProfileDto}" 
          method="post" 
          enctype="multipart/form-data">
        
        <div class="profile-img-preview">
            <img id="imagePreview" th:src="@{/uploads/i3.jpg}" alt="Profile Image">
        </div>
        
        <div class="form-group">
            <label for="file">Profile Picture:</label>
            <input type="file" id="file" name="file" onchange="previewImage(event)"/>
        </div>

        <div class="form-group">
            <label for="name">Name:</label>
            <input type="text" 
                   th:field="*{name}" 
                   id="fullname" 
                   th:classappend="${#fields.hasErrors('name')} ? 'is-invalid'" />
            <p th:if="${#fields.hasErrors('name')}" 
               th:errors="*{name}" 
               class="text-danger">Name Error</p>
        </div>

        <div class="form-group">
            <label for="email">Email:</label>
            <input type="email" 
                   th:field="*{email}" 
                   id="email" 
                   th:classappend="${#fields.hasErrors('email')} ? 'is-invalid'" />
            <p th:if="${#fields.hasErrors('email')}" 
               th:errors="*{email}" 
               class="text-danger">Email Error</p>
        </div>
        
        <div class="form-group">
            <label for="phoneNumber">Phone:</label>
            <input type="text" 
                   th:field="*{phoneNumber}" 
                   id="phoneNumber" 
                   th:classappend="${#fields.hasErrors('phoneNumber')} ? 'is-invalid'" />
            <p th:if="${#fields.hasErrors('phoneNumber')}" 
               th:errors="*{phoneNumber}" 
               class="text-danger">Phone Error</p>
        </div>

        <div class="form-group">
            <label for="address">Address:</label>
            <input type="text" 
                   th:field="*{address}" 
                   id="address"
                   th:classappend="${#fields.hasErrors('address')} ? 'is-invalid'" />
            <p th:if="${#fields.hasErrors('address')}" 
               th:errors="*{address}" 
               class="text-danger">Address Error</p>
        </div>

        <div class="form-group">
            <label for="gender">Gender:</label>
            <select th:field="*{gender}" 
                    id="gender"
                    th:classappend="${#fields.hasErrors('gender')} ? 'is-invalid'">
                <option value="" disabled selected>Select Gender</option>
                <option value="Male">Male</option>
                <option value="Female">Female</option>
            </select>
            <p th:if="${#fields.hasErrors('gender')}" 
               th:errors="*{gender}" 
               class="text-danger">Gender Error</p>
        </div>
        
        <div class="d-flex">
            <button type="submit" class="btn btn-primary">Save</button>
            <a th:href="@{/userprofile}" class="btn btn-secondary">Cancel</a>
        </div>
    </form>
</div>

<script>
    function previewImage(event) {
        const reader = new FileReader();
        reader.onload = function(){
            const output = document.getElementById('imagePreview');
            output.src = reader.result;
        };
        if (event.target.files.length > 0) {
            reader.readAsDataURL(event.target.files[0]);
        }
    }
</script>

</body>
</html>